<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>CatRoyal üêæ</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/mobile.css">
</head>
<body>

    <!-- ==================== LOGIN ==================== -->
    <div id="page-login" class="page">
        <div class="login-box">
            <h1>üêæ CatRoyal</h1>
            <input type="text" id="input-pseudo" placeholder="Pseudo" maxlength="20" autocomplete="off">
            <input type="password" id="input-password" placeholder="Mot de passe" autocomplete="off">
            <button id="btn-login" class="btn-primary">Connexion</button>
            <div id="login-error" class="error-msg"></div>
        </div>
    </div>

    <!-- ==================== DASHBOARD ==================== -->
    <div id="page-dashboard" class="page" style="display:none;">
        <div class="header">
            <h1>üêæ CatRoyal</h1>
            <div class="user-info">
                <span id="user-pseudo"></span>
                <button id="btn-logout" class="btn-secondary">D√©co</button>
            </div>
        </div>

        <div class="content">
            <section class="section">
                <h2>Parties</h2>
                <button id="btn-create-game" class="btn-primary">+ Cr√©er</button>
                <div id="games-list" class="list"></div>
            </section>

            <section class="section">
                <h2>Maps</h2>
                <button id="btn-create-map" class="btn-primary">+ Cr√©er</button>
                <div id="maps-list" class="list"></div>
            </section>
        </div>
    </div>

    <!-- ==================== LOBBY ==================== -->
    <div id="page-lobby" class="page" style="display:none;">
        <div class="header">
            <button id="btn-leave-lobby" class="btn-back">‚Üê Retour</button>
            <h2>Lobby</h2>
        </div>

        <div class="content">
            <section class="section">
                <h3>Map</h3>
                <select id="lobby-map-select" class="select-input">
                    <option value="">-- Choisir --</option>
                </select>
                <div id="lobby-map-info"></div>
            </section>

            <section class="section">
                <h3>Joueurs (<span id="lobby-player-count">0</span>)</h3>
                <div id="lobby-players-list" class="players-grid"></div>
            </section>

            <section class="section" id="lobby-teams-section" style="display:none;">
                <h3>√âquipes</h3>
                <div class="btn-group">
                    <button id="btn-auto-teams" class="btn-secondary">üé≤ Auto</button>
                    <button id="btn-manual-teams" class="btn-secondary">‚úã Manuel</button>
                </div>
                <div id="teams-preview"></div>
            </section>

            <section class="section" id="lobby-modifiers-section" style="display:none;">
                <h3>Modifiers</h3>
                <div class="btn-group">
                    <button id="btn-random-modifier" class="btn-secondary">üé≤ Al√©atoire</button>
                    <button id="btn-manual-modifiers" class="btn-secondary">‚úã Manuel</button>
                </div>
                <div id="modifiers-list"></div>
            </section>

            <button id="btn-start-game" class="btn-primary btn-big" style="display:none;">
                üöÄ Lancer
            </button>
        </div>
    </div>

    <!-- ==================== EDITOR ==================== -->
    <div id="page-editor" class="page" style="display:none;">
        <div class="editor-ui">
            <button id="btn-leave-editor" class="btn-back">‚Üê Retour</button>
            <input type="text" id="map-name-input" placeholder="Nom de la map" maxlength="30">
            <div id="zone-count">Zones: 0</div>
        </div>

        <div class="editor-controls">
            <button id="btn-snap" class="btn-editor active">Aimant</button>
            <button id="btn-save-map" class="btn-editor">üíæ Save</button>
            <button id="btn-delete-map" class="btn-editor" style="display:none;">üóëÔ∏è Suppr</button>
        </div>

        <div id="custom-cursor"><div id="cursor-dot"></div></div>
        <div id="map-editor"></div>
    </div>

    <!-- ==================== GAME ==================== -->
    <div id="page-game" class="page" style="display:none;">
        <div id="modifier-border" class="modifier-border" style="display:none;"></div>

        <div class="game-ui">
            <div class="game-header">
                <div class="timer-box">
                    <div id="game-phase" class="phase-text">Cache</div>
                    <div id="game-timer" class="timer-text">3:00</div>
                </div>
                <button id="btn-notifications" class="btn-notif">
                    üîî <span id="notif-badge" class="badge" style="display:none;">0</span>
                </button>
            </div>

            <div class="game-stats">
                <div class="role-badge" id="player-role">SOURIS</div>
                <div class="stat-row" id="hp-display" style="display:none;">
                    <span>PV:</span>
                    <div class="hp-bar"><div id="hp-fill"></div></div>
                    <span id="hp-value">100</span>
                </div>
                <div class="stat-row">√âquipe: <span id="team-name">--</span></div>
            </div>

            <div id="mission-display" class="mission-box" style="display:none;"></div>

            <div id="cat-controls" class="controls" style="display:none;">
                <div class="info-text">Supprimer: <span id="zones-to-delete">0</span></div>
                <div id="final-zone-info" class="info-text"></div>
                <div id="cat-modifiers"></div>
            </div>

            <div id="mouse-controls" class="controls" style="display:none;">
                <button id="btn-declare-touched" class="btn-danger">‚ùå Touch√©</button>
                <div id="mouse-modifiers"></div>
            </div>

            <button id="btn-quit-game" class="btn-danger btn-small">Quitter</button>
        </div>

        <div id="notifications-panel" class="notif-panel" style="display:none;">
            <div class="notif-header">
                <h3>Notifs</h3>
                <button id="btn-close-notifs" class="btn-close">‚úï</button>
            </div>
            <div id="notifications-list" class="notif-list"></div>
        </div>

        <div id="map-game"></div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>
    
    <script src="js/config.js"></script>
    <script src="js/firebase-helpers.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/navigation.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/lobby.js"></script>
    <script src="js/editor.js"></script>
    <script src="js/game/game-notifications.js"></script>
    <script src="js/game/game-modifiers.js"></script>
    <script src="js/game/game-pings.js"></script>
    <script src="js/game/game-zones.js"></script>
    <script src="js/game/game-timer.js"></script>
    <script src="js/game/game-main.js"></script>
</body>
</html>
